// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// ĞĞĞ¡Ğ¢Ğ ĞĞ™ĞšĞ˜ API
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

const API_URL = "/api/groq";

const MODELS = [
    "llama-3.1-70b-versatile",
    "llama-3.1-8b-instant",
    "mixtral-8x7b-32768"
];


// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// Ğ¡Ğ˜Ğ¡Ğ¢Ğ•ĞœĞĞ«Ğ™ ĞŸĞ ĞĞœĞŸĞ¢
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

const SYSTEM_PROMPT = `Ğ¢Ñ‹ ÑĞ¾Ğ·Ğ´Ğ°Ñ‘ÑˆÑŒ Ñ€Ğ°Ğ±Ğ¾Ñ‡Ğ¸Ğµ Ğ»Ğ¸ÑÑ‚Ñ‹ Ğ´Ğ»Ñ Ğ´ĞµÑ‚ĞµĞ¹ Ğ½Ğ°Ñ‡Ğ°Ğ»ÑŒĞ½Ğ¾Ğ¹ ÑˆĞºĞ¾Ğ»Ñ‹ Ğ Ğ¾ÑÑĞ¸Ğ¸ (1-4 ĞºĞ»Ğ°ÑÑ).

Ğ–Ğ•Ğ›Ğ•Ğ—ĞĞ«Ğ• ĞŸĞ ĞĞ’Ğ˜Ğ›Ğ:
1. ĞŸĞ¸ÑˆĞ¸ Ğ¢ĞĞ›Ğ¬ĞšĞ Ğ¿Ğ¾-Ñ€ÑƒÑÑĞºĞ¸
2. Ğ—Ğ°Ğ´Ğ°Ğ½Ğ¸Ñ Ñ€ĞµÑˆĞ°ÑÑ‚ÑÑ ĞšĞĞ ĞĞĞ”ĞĞ¨ĞĞœ Ğ½Ğ° Ğ‘Ğ£ĞœĞĞ“Ğ•
3. ĞšĞ°Ğ¶Ğ´Ğ¾Ğµ Ğ·Ğ°Ğ´Ğ°Ğ½Ğ¸Ğµ â€” ÑÑ‚Ğ¾ Ğ¡ĞŸĞ˜Ğ¡ĞĞš ĞºĞ¾Ğ½ĞºÑ€ĞµÑ‚Ğ½Ñ‹Ñ… Ğ¿Ñ€Ğ¸Ğ¼ĞµÑ€Ğ¾Ğ²
4. ĞÑ‚Ğ²ĞµÑ‚Ñ‹ Ğ´Ğ¾Ğ»Ğ¶Ğ½Ñ‹ Ğ±Ñ‹Ñ‚ÑŒ ĞĞ”ĞĞĞ—ĞĞĞ§ĞĞ«ĞœĞ˜

Ğ—ĞĞŸĞ Ğ•Ğ©Ğ•ĞĞ:
- ĞĞ±ÑÑ‚Ñ€Ğ°ĞºÑ‚Ğ½Ñ‹Ğµ Ğ·Ğ°Ğ´Ğ°Ğ½Ğ¸Ñ Ğ±ĞµĞ· Ğ¿Ñ€Ğ¸Ğ¼ĞµÑ€Ğ¾Ğ²
- Ğ¡Ğ»Ğ¾Ğ²Ğ°: ĞºÑƒĞ¿Ğ¸, ÑÑ…Ğ¾Ğ´Ğ¸, Ğ¿Ñ€Ğ¸Ğ³Ğ¾Ñ‚Ğ¾Ğ²ÑŒ, Ğ²Ğ¸Ğ´ĞµĞ¾, Ğ¸Ğ½Ñ‚ĞµÑ€Ğ½ĞµÑ‚

Ğ¤ĞĞ ĞœĞĞ¢ Ğ­Ğ›Ğ•ĞœĞ•ĞĞ¢ĞĞ’:
- ĞšĞ°Ğ¶Ğ´Ñ‹Ğ¹ element â€” ÑÑ‚Ğ¾ ĞĞ”Ğ˜Ğ Ğ¿Ñ€Ğ¸Ğ¼ĞµÑ€ Ğ´Ğ»Ñ Ñ€ĞµÑˆĞµĞ½Ğ¸Ñ
- ĞšĞ°Ğ¶Ğ´Ñ‹Ğ¹ answer â€” ÑÑ‚Ğ¾ ĞĞ”Ğ˜Ğ Ğ¿Ñ€Ğ°Ğ²Ğ¸Ğ»ÑŒĞ½Ñ‹Ğ¹ Ğ¾Ñ‚Ğ²ĞµÑ‚
- ĞšĞ¾Ğ»Ğ¸Ñ‡ĞµÑÑ‚Ğ²Ğ¾ elements = ĞºĞ¾Ğ»Ğ¸Ñ‡ĞµÑÑ‚Ğ²Ğ¾ answers`;


// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// ĞŸĞ Ğ˜ĞœĞ•Ğ Ğ« Ğ—ĞĞ”ĞĞĞ˜Ğ™ ĞŸĞ Ğ¢Ğ•ĞœĞĞœ
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

const TASK_EXAMPLES = {
    // ĞŸĞ°Ğ´ĞµĞ¶Ğ¸ ÑÑƒÑ‰ĞµÑÑ‚Ğ²Ğ¸Ñ‚ĞµĞ»ÑŒĞ½Ñ‹Ñ…
    "Ğ¿Ğ°Ğ´ĞµĞ¶": `
Ğ¢Ğ•ĞœĞ: ĞŸĞ°Ğ´ĞµĞ¶Ğ¸ ÑÑƒÑ‰ĞµÑÑ‚Ğ²Ğ¸Ñ‚ĞµĞ»ÑŒĞ½Ñ‹Ñ…

ĞŸÑ€Ğ¸Ğ¼ĞµÑ€ 1 - ĞĞ¿Ñ€ĞµĞ´ĞµĞ»Ğ¸ Ğ¿Ğ°Ğ´ĞµĞ¶:
{
  "level": "â­",
  "level_name": "ĞĞ¿Ñ€ĞµĞ´ĞµĞ»Ğ¸ Ğ¿Ğ°Ğ´ĞµĞ¶",
  "instruction": "ĞĞ¿Ñ€ĞµĞ´ĞµĞ»Ğ¸ Ğ¿Ğ°Ğ´ĞµĞ¶ Ğ²Ñ‹Ğ´ĞµĞ»ĞµĞ½Ğ½Ğ¾Ğ³Ğ¾ ÑÑƒÑ‰ĞµÑÑ‚Ğ²Ğ¸Ñ‚ĞµĞ»ÑŒĞ½Ğ¾Ğ³Ğ¾. ĞĞ°Ğ¿Ğ¸ÑˆĞ¸ ÑĞ¾ĞºÑ€Ğ°Ñ‰Ñ‘Ğ½Ğ½Ğ¾: Ğ˜.Ğ¿., Ğ .Ğ¿., Ğ”.Ğ¿., Ğ’.Ğ¿., Ğ¢.Ğ¿., ĞŸ.Ğ¿.",
  "content": "",
  "elements": [
    "ĞœĞ°Ğ¼Ğ° Ñ‡Ğ¸Ñ‚Ğ°ĞµÑ‚ ĞšĞĞ˜Ğ“Ğ£.",
    "ĞĞ° Ğ¡Ğ¢ĞĞ›Ğ• Ğ»ĞµĞ¶Ğ¸Ñ‚ Ñ‚ĞµÑ‚Ñ€Ğ°Ğ´ÑŒ.",
    "Ğ¯ Ğ¸Ğ´Ñƒ Ğº Ğ‘ĞĞ‘Ğ£Ğ¨ĞšĞ•.",
    "ĞœĞĞ›Ğ¬Ğ§Ğ˜Ğš Ğ¸Ğ³Ñ€Ğ°ĞµÑ‚ Ğ²Ğ¾ Ğ´Ğ²Ğ¾Ñ€Ğµ.",
    "ĞšĞ¾ÑˆĞºĞ° ÑĞ¿Ğ¸Ñ‚ Ğ¿Ğ¾Ğ´ Ğ”Ğ˜Ğ’ĞĞĞĞœ.",
    "Ğ£ Ğ¡Ğ•Ğ¡Ğ¢Ğ Ğ« ĞºÑ€Ğ°ÑĞ¸Ğ²Ğ¾Ğµ Ğ¿Ğ»Ğ°Ñ‚ÑŒĞµ."
  ],
  "answers": ["Ğ’.Ğ¿.", "ĞŸ.Ğ¿.", "Ğ”.Ğ¿.", "Ğ˜.Ğ¿.", "Ğ¢.Ğ¿.", "Ğ .Ğ¿."]
}

ĞŸÑ€Ğ¸Ğ¼ĞµÑ€ 2 - ĞŸĞ¾ÑÑ‚Ğ°Ğ²ÑŒ Ğ² Ğ½ÑƒĞ¶Ğ½Ñ‹Ğ¹ Ğ¿Ğ°Ğ´ĞµĞ¶:
{
  "level": "â­â­",
  "level_name": "Ğ˜Ğ·Ğ¼ĞµĞ½Ğ¸ Ğ¿Ğ¾ Ğ¿Ğ°Ğ´ĞµĞ¶Ğ°Ğ¼",
  "instruction": "ĞŸĞ¾ÑÑ‚Ğ°Ğ²ÑŒ ÑĞ»Ğ¾Ğ²Ğ¾ Ğ² ÑĞºĞ¾Ğ±ĞºĞ°Ñ… Ğ² Ğ½ÑƒĞ¶Ğ½Ñ‹Ğ¹ Ğ¿Ğ°Ğ´ĞµĞ¶.",
  "content": "",
  "elements": [
    "Ğ¯ Ğ²Ğ¸Ğ¶Ñƒ (ÑĞ¾Ğ±Ğ°ĞºĞ°) â€” ___",
    "ĞŸĞ¾Ğ´Ğ°Ñ€Ğ¾Ğº Ğ´Ğ»Ñ (Ğ¼Ğ°Ğ¼Ğ°) â€” ___",
    "Ğ˜Ğ´Ñƒ Ğº (Ğ´Ñ€ÑƒĞ³) â€” ___",
    "Ğ“Ğ¾Ñ€Ğ¶ÑƒÑÑŒ (Ğ±Ñ€Ğ°Ñ‚) â€” ___",
    "Ğ”ÑƒĞ¼Ğ°Ñ Ğ¾ (Ğ»ĞµÑ‚Ğ¾) â€” ___",
    "ĞĞµÑ‚ (Ñ€ÑƒÑ‡ĞºĞ°) â€” ___"
  ],
  "answers": ["ÑĞ¾Ğ±Ğ°ĞºÑƒ", "Ğ¼Ğ°Ğ¼Ñ‹", "Ğ´Ñ€ÑƒĞ³Ñƒ", "Ğ±Ñ€Ğ°Ñ‚Ğ¾Ğ¼", "Ğ»ĞµÑ‚Ğµ", "Ñ€ÑƒÑ‡ĞºĞ¸"]
}

ĞŸÑ€Ğ¸Ğ¼ĞµÑ€ 3 - ĞŸĞ°Ğ´ĞµĞ¶Ğ½Ñ‹Ğµ Ğ²Ğ¾Ğ¿Ñ€Ğ¾ÑÑ‹:
{
  "level": "â­â­â­",
  "level_name": "Ğ’Ğ¾Ğ¿Ñ€Ğ¾ÑÑ‹ Ğ¿Ğ°Ğ´ĞµĞ¶ĞµĞ¹",
  "instruction": "Ğ¡Ğ¾ĞµĞ´Ğ¸Ğ½Ğ¸ Ğ¿Ğ°Ğ´ĞµĞ¶ Ğ¸ ĞµĞ³Ğ¾ Ğ²Ğ¾Ğ¿Ñ€Ğ¾ÑÑ‹.",
  "content": "",
  "elements": [
    "Ğ˜Ğ¼ĞµĞ½Ğ¸Ñ‚ĞµĞ»ÑŒĞ½Ñ‹Ğ¹ â€” ?",
    "Ğ Ğ¾Ğ´Ğ¸Ñ‚ĞµĞ»ÑŒĞ½Ñ‹Ğ¹ â€” ?",
    "Ğ”Ğ°Ñ‚ĞµĞ»ÑŒĞ½Ñ‹Ğ¹ â€” ?",
    "Ğ’Ğ¸Ğ½Ğ¸Ñ‚ĞµĞ»ÑŒĞ½Ñ‹Ğ¹ â€” ?",
    "Ğ¢Ğ²Ğ¾Ñ€Ğ¸Ñ‚ĞµĞ»ÑŒĞ½Ñ‹Ğ¹ â€” ?",
    "ĞŸÑ€ĞµĞ´Ğ»Ğ¾Ğ¶Ğ½Ñ‹Ğ¹ â€” ?"
  ],
  "answers": ["ĞºÑ‚Ğ¾? Ñ‡Ñ‚Ğ¾?", "ĞºĞ¾Ğ³Ğ¾? Ñ‡ĞµĞ³Ğ¾?", "ĞºĞ¾Ğ¼Ñƒ? Ñ‡ĞµĞ¼Ñƒ?", "ĞºĞ¾Ğ³Ğ¾? Ñ‡Ñ‚Ğ¾?", "ĞºĞµĞ¼? Ñ‡ĞµĞ¼?", "Ğ¾ ĞºĞ¾Ğ¼? Ğ¾ Ñ‡Ñ‘Ğ¼?"]
}

ĞŸÑ€Ğ¸Ğ¼ĞµÑ€ 4 - ĞĞ°Ğ¹Ğ´Ğ¸ ÑÑƒÑ‰ĞµÑÑ‚Ğ²Ğ¸Ñ‚ĞµĞ»ÑŒĞ½Ğ¾Ğµ Ğ² Ğ¿Ğ°Ğ´ĞµĞ¶Ğµ:
{
  "level": "â­â­",
  "level_name": "ĞĞ°Ğ¹Ğ´Ğ¸ Ğ¿Ğ°Ğ´ĞµĞ¶",
  "instruction": "Ğ’Ñ‹Ğ¿Ğ¸ÑˆĞ¸ Ğ¸Ğ· Ğ¿Ñ€ĞµĞ´Ğ»Ğ¾Ğ¶ĞµĞ½Ğ¸Ñ ÑÑƒÑ‰ĞµÑÑ‚Ğ²Ğ¸Ñ‚ĞµĞ»ÑŒĞ½Ğ¾Ğµ Ğ² ÑƒĞºĞ°Ğ·Ğ°Ğ½Ğ½Ğ¾Ğ¼ Ğ¿Ğ°Ğ´ĞµĞ¶Ğµ.",
  "content": "",
  "elements": [
    "ĞœĞ°Ğ»ÑŒÑ‡Ğ¸Ğº Ñ‡Ğ¸Ñ‚Ğ°ĞµÑ‚ ĞºĞ½Ğ¸Ğ³Ñƒ Ğ² ĞºĞ¾Ğ¼Ğ½Ğ°Ñ‚Ğµ. (Ğ’.Ğ¿.) â€” ___",
    "Ğ¡Ğ¾Ğ±Ğ°ĞºĞ° Ğ»ĞµĞ¶Ğ¸Ñ‚ Ğ¿Ğ¾Ğ´ ÑÑ‚Ğ¾Ğ»Ğ¾Ğ¼. (Ğ¢.Ğ¿.) â€” ___",
    "ĞŸĞ¸ÑÑŒĞ¼Ğ¾ Ğ¾Ñ‚ Ğ±Ğ°Ğ±ÑƒÑˆĞºĞ¸ Ğ»ĞµĞ¶Ğ¸Ñ‚ Ğ½Ğ° Ğ¿Ğ¾Ğ»ĞºĞµ. (Ğ .Ğ¿.) â€” ___",
    "Ğ”ĞµÑ‚Ğ¸ Ğ±ĞµĞ³ÑƒÑ‚ Ğº ÑˆĞºĞ¾Ğ»Ğµ. (Ğ”.Ğ¿.) â€” ___",
    "ĞŸÑ‚Ğ¸Ñ†Ğ° ÑĞ¸Ğ´Ğ¸Ñ‚ Ğ½Ğ° Ğ²ĞµÑ‚ĞºĞµ. (ĞŸ.Ğ¿.) â€” ___",
    "ĞšĞ¾Ñ‚ Ğ¿ÑŒÑ‘Ñ‚ Ğ¼Ğ¾Ğ»Ğ¾ĞºĞ¾. (Ğ˜.Ğ¿.) â€” ___"
  ],
  "answers": ["ĞºĞ½Ğ¸Ğ³Ñƒ", "ÑÑ‚Ğ¾Ğ»Ğ¾Ğ¼", "Ğ±Ğ°Ğ±ÑƒÑˆĞºĞ¸", "ÑˆĞºĞ¾Ğ»Ğµ", "Ğ²ĞµÑ‚ĞºĞµ", "ĞºĞ¾Ñ‚"]
}`,

    // Ğ¡ĞºĞ»Ğ¾Ğ½ĞµĞ½Ğ¸Ğµ ÑÑƒÑ‰ĞµÑÑ‚Ğ²Ğ¸Ñ‚ĞµĞ»ÑŒĞ½Ñ‹Ñ…
    "ÑĞºĞ»Ğ¾Ğ½ĞµĞ½": `
Ğ¢Ğ•ĞœĞ: Ğ¡ĞºĞ»Ğ¾Ğ½ĞµĞ½Ğ¸Ğµ ÑÑƒÑ‰ĞµÑÑ‚Ğ²Ğ¸Ñ‚ĞµĞ»ÑŒĞ½Ñ‹Ñ…

ĞŸÑ€Ğ¸Ğ¼ĞµÑ€ 1 - ĞĞ¿Ñ€ĞµĞ´ĞµĞ»Ğ¸ ÑĞºĞ»Ğ¾Ğ½ĞµĞ½Ğ¸Ğµ:
{
  "level": "â­",
  "level_name": "ĞĞ¿Ñ€ĞµĞ´ĞµĞ»Ğ¸ ÑĞºĞ»Ğ¾Ğ½ĞµĞ½Ğ¸Ğµ",
  "instruction": "ĞĞ¿Ñ€ĞµĞ´ĞµĞ»Ğ¸ ÑĞºĞ»Ğ¾Ğ½ĞµĞ½Ğ¸Ğµ ÑÑƒÑ‰ĞµÑÑ‚Ğ²Ğ¸Ñ‚ĞµĞ»ÑŒĞ½Ğ¾Ğ³Ğ¾. ĞĞ°Ğ¿Ğ¸ÑˆĞ¸: 1 ÑĞºĞ»., 2 ÑĞºĞ». Ğ¸Ğ»Ğ¸ 3 ÑĞºĞ».",
  "content": "ĞŸĞ¾Ğ¼Ğ½Ğ¸: 1 ÑĞºĞ». â€” Ğ¶.Ñ€. Ğ¸ Ğ¼.Ñ€. Ğ½Ğ° -Ğ°/-Ñ, 2 ÑĞºĞ». â€” Ğ¼.Ñ€. Ğ¸ ÑÑ€.Ñ€., 3 ÑĞºĞ». â€” Ğ¶.Ñ€. Ğ½Ğ° ÑŒ",
  "elements": [
    "Ğ¼Ğ°Ğ¼Ğ° â€” ___",
    "ĞºĞ¾Ğ½ÑŒ â€” ___",
    "Ğ½Ğ¾Ñ‡ÑŒ â€” ___",
    "Ğ´ÑĞ´Ñ â€” ___",
    "Ğ¾ĞºĞ½Ğ¾ â€” ___",
    "Ğ¼Ñ‹ÑˆÑŒ â€” ___",
    "Ğ¿Ğ°Ğ¿Ğ° â€” ___",
    "Ğ¼Ğ¾Ñ€Ğµ â€” ___"
  ],
  "answers": ["1 ÑĞºĞ».", "2 ÑĞºĞ».", "3 ÑĞºĞ».", "1 ÑĞºĞ».", "2 ÑĞºĞ».", "3 ÑĞºĞ».", "1 ÑĞºĞ».", "2 ÑĞºĞ»."]
}

ĞŸÑ€Ğ¸Ğ¼ĞµÑ€ 2 - Ğ Ğ°Ğ·Ğ´ĞµĞ»Ğ¸ Ğ½Ğ° Ğ³Ñ€ÑƒĞ¿Ğ¿Ñ‹:
{
  "level": "â­â­",
  "level_name": "Ğ“Ñ€ÑƒĞ¿Ğ¿Ñ‹ Ğ¿Ğ¾ ÑĞºĞ»Ğ¾Ğ½ĞµĞ½Ğ¸Ñ",
  "instruction": "Ğ Ğ°ÑĞ¿Ñ€ĞµĞ´ĞµĞ»Ğ¸ ÑĞ»Ğ¾Ğ²Ğ° Ğ¿Ğ¾ ÑĞºĞ»Ğ¾Ğ½ĞµĞ½Ğ¸ÑĞ¼. ĞĞ°Ğ¿Ğ¸ÑˆĞ¸ Ğ½Ğ¾Ğ¼ĞµÑ€ ÑĞºĞ»Ğ¾Ğ½ĞµĞ½Ğ¸Ñ.",
  "content": "",
  "elements": [
    "Ğ·ĞµĞ¼Ğ»Ñ â€” ___",
    "Ğ´Ğ²ĞµÑ€ÑŒ â€” ___",
    "ÑÑ‚Ğ¾Ğ» â€” ___",
    "Ñ‚Ñ‘Ñ‚Ñ â€” ___",
    "ÑĞ¾Ğ»Ğ½Ñ†Ğµ â€” ___",
    "ÑÑ‚ĞµĞ¿ÑŒ â€” ___"
  ],
  "answers": ["1", "3", "2", "1", "2", "3"]
}`,

    // ĞĞºĞ¾Ğ½Ñ‡Ğ°Ğ½Ğ¸Ñ ÑÑƒÑ‰ĞµÑÑ‚Ğ²Ğ¸Ñ‚ĞµĞ»ÑŒĞ½Ñ‹Ñ…
    "Ğ¾ĞºĞ¾Ğ½Ñ‡Ğ°Ğ½": `
Ğ¢Ğ•ĞœĞ: ĞĞºĞ¾Ğ½Ñ‡Ğ°Ğ½Ğ¸Ñ ÑÑƒÑ‰ĞµÑÑ‚Ğ²Ğ¸Ñ‚ĞµĞ»ÑŒĞ½Ñ‹Ñ…

ĞŸÑ€Ğ¸Ğ¼ĞµÑ€ 1 - Ğ’ÑÑ‚Ğ°Ğ²ÑŒ Ğ¾ĞºĞ¾Ğ½Ñ‡Ğ°Ğ½Ğ¸Ğµ:
{
  "level": "â­â­",
  "level_name": "Ğ’ÑÑ‚Ğ°Ğ²ÑŒ Ğ¾ĞºĞ¾Ğ½Ñ‡Ğ°Ğ½Ğ¸Ğµ",
  "instruction": "Ğ’ÑÑ‚Ğ°Ğ²ÑŒ Ğ¿Ñ€Ğ¾Ğ¿ÑƒÑ‰ĞµĞ½Ğ½Ğ¾Ğµ Ğ¾ĞºĞ¾Ğ½Ñ‡Ğ°Ğ½Ğ¸Ğµ ÑÑƒÑ‰ĞµÑÑ‚Ğ²Ğ¸Ñ‚ĞµĞ»ÑŒĞ½Ğ¾Ğ³Ğ¾.",
  "content": "",
  "elements": [
    "Ğ½Ğ° Ğ¿Ğ°Ñ€Ñ‚_ (1 ÑĞºĞ»., ĞŸ.Ğ¿.)",
    "Ñƒ Ğ´Ğ¾Ñ€Ğ¾Ğ³_ (1 ÑĞºĞ»., Ğ .Ğ¿.)",
    "Ğº Ğ±Ğ°Ğ±ÑƒÑˆĞº_ (1 ÑĞºĞ»., Ğ”.Ğ¿.)",
    "Ğ² Ñ‚ĞµÑ‚Ñ€Ğ°Ğ´_ (3 ÑĞºĞ»., ĞŸ.Ğ¿.)",
    "Ğ±ĞµĞ· Ğ¿Ğ¾Ğ»_ (2 ÑĞºĞ»., Ğ .Ğ¿.)",
    "Ğ¾ Ğ¼Ğ°Ğ¼_ (1 ÑĞºĞ»., ĞŸ.Ğ¿.)"
  ],
  "answers": ["-Ğµ", "-Ğ¸", "-Ğµ", "-Ğ¸", "-Ñ", "-Ğµ"]
}

ĞŸÑ€Ğ¸Ğ¼ĞµÑ€ 2 - Ğ’Ñ‹Ğ±ĞµÑ€Ğ¸ Ğ¾ĞºĞ¾Ğ½Ñ‡Ğ°Ğ½Ğ¸Ğµ:
{
  "level": "â­â­â­",
  "level_name": "Ğ’Ñ‹Ğ±ĞµÑ€Ğ¸ Ğ¿Ñ€Ğ°Ğ²Ğ¸Ğ»ÑŒĞ½Ğ¾Ğµ",
  "instruction": "Ğ’Ñ‹Ğ±ĞµÑ€Ğ¸ Ğ¿Ñ€Ğ°Ğ²Ğ¸Ğ»ÑŒĞ½Ğ¾Ğµ Ğ¾ĞºĞ¾Ğ½Ñ‡Ğ°Ğ½Ğ¸Ğµ: -Ğ• Ğ¸Ğ»Ğ¸ -Ğ˜?",
  "content": "",
  "elements": [
    "Ğ½Ğ° Ğ¿Ğ»Ğ¾Ñ‰Ğ°Ğ´_ (-Ğµ/-Ğ¸)",
    "Ğ² Ğ´ĞµÑ€ĞµĞ²Ğ½_ (-Ğµ/-Ğ¸)",
    "Ğ¾ Ğ¿Ğ¾Ğ´Ñ€ÑƒĞ³_ (-Ğµ/-Ğ¸)",
    "Ğ² Ñ‚ĞµÑ‚Ñ€Ğ°Ğ´_ (-Ğµ/-Ğ¸)",
    "Ğ½Ğ° Ğ»Ğ¾ÑˆĞ°Ğ´_ (-Ğµ/-Ğ¸)",
    "Ğº Ğ·ĞµĞ¼Ğ»_ (-Ğµ/-Ğ¸)"
  ],
  "answers": ["-Ğ¸", "-Ğµ", "-Ğµ", "-Ğ¸", "-Ğ¸", "-Ğµ"]
}`,

    // Ğ¡Ğ¿Ñ€ÑĞ¶ĞµĞ½Ğ¸Ğµ Ğ³Ğ»Ğ°Ğ³Ğ¾Ğ»Ğ¾Ğ²
    "ÑĞ¿Ñ€ÑĞ¶ĞµĞ½": `
Ğ¢Ğ•ĞœĞ: Ğ¡Ğ¿Ñ€ÑĞ¶ĞµĞ½Ğ¸Ğµ Ğ³Ğ»Ğ°Ğ³Ğ¾Ğ»Ğ¾Ğ²

ĞŸÑ€Ğ¸Ğ¼ĞµÑ€ 1 - ĞĞ¿Ñ€ĞµĞ´ĞµĞ»Ğ¸ ÑĞ¿Ñ€ÑĞ¶ĞµĞ½Ğ¸Ğµ:
{
  "level": "â­",
  "level_name": "ĞĞ¿Ñ€ĞµĞ´ĞµĞ»Ğ¸ ÑĞ¿Ñ€ÑĞ¶ĞµĞ½Ğ¸Ğµ",
  "instruction": "ĞĞ¿Ñ€ĞµĞ´ĞµĞ»Ğ¸ ÑĞ¿Ñ€ÑĞ¶ĞµĞ½Ğ¸Ğµ Ğ³Ğ»Ğ°Ğ³Ğ¾Ğ»Ğ°. ĞĞ°Ğ¿Ğ¸ÑˆĞ¸: I ÑĞ¿Ñ€. Ğ¸Ğ»Ğ¸ II ÑĞ¿Ñ€.",
  "content": "II ÑĞ¿Ñ€.: Ğ³Ğ»Ğ°Ğ³Ğ¾Ğ»Ñ‹ Ğ½Ğ° -Ğ¸Ñ‚ÑŒ (ĞºÑ€Ğ¾Ğ¼Ğµ Ğ±Ñ€Ğ¸Ñ‚ÑŒ, ÑÑ‚ĞµĞ»Ğ¸Ñ‚ÑŒ) + Ğ³Ğ½Ğ°Ñ‚ÑŒ, Ğ´ĞµÑ€Ğ¶Ğ°Ñ‚ÑŒ, Ğ´Ñ‹ÑˆĞ°Ñ‚ÑŒ, ÑĞ»Ñ‹ÑˆĞ°Ñ‚ÑŒ, Ğ²Ğ¸Ğ´ĞµÑ‚ÑŒ, Ğ½ĞµĞ½Ğ°Ğ²Ğ¸Ğ´ĞµÑ‚ÑŒ, ÑĞ¼Ğ¾Ñ‚Ñ€ĞµÑ‚ÑŒ, Ğ²ĞµÑ€Ñ‚ĞµÑ‚ÑŒ, Ğ¾Ğ±Ğ¸Ğ´ĞµÑ‚ÑŒ, Ğ·Ğ°Ğ²Ğ¸ÑĞµÑ‚ÑŒ, Ñ‚ĞµÑ€Ğ¿ĞµÑ‚ÑŒ",
  "elements": [
    "Ñ‡Ğ¸Ñ‚Ğ°Ñ‚ÑŒ â€” ___",
    "Ğ³Ğ¾Ğ²Ğ¾Ñ€Ğ¸Ñ‚ÑŒ â€” ___",
    "Ğ¿Ğ¸ÑĞ°Ñ‚ÑŒ â€” ___",
    "ÑĞ¼Ğ¾Ñ‚Ñ€ĞµÑ‚ÑŒ â€” ___",
    "Ğ¸Ğ³Ñ€Ğ°Ñ‚ÑŒ â€” ___",
    "ÑÑ‚Ñ€Ğ¾Ğ¸Ñ‚ÑŒ â€” ___"
  ],
  "answers": ["I ÑĞ¿Ñ€.", "II ÑĞ¿Ñ€.", "I ÑĞ¿Ñ€.", "II ÑĞ¿Ñ€.", "I ÑĞ¿Ñ€.", "II ÑĞ¿Ñ€."]
}

ĞŸÑ€Ğ¸Ğ¼ĞµÑ€ 2 - Ğ’ÑÑ‚Ğ°Ğ²ÑŒ Ğ¾ĞºĞ¾Ğ½Ñ‡Ğ°Ğ½Ğ¸Ğµ Ğ³Ğ»Ğ°Ğ³Ğ¾Ğ»Ğ°:
{
  "level": "â­â­",
  "level_name": "ĞĞºĞ¾Ğ½Ñ‡Ğ°Ğ½Ğ¸Ñ Ğ³Ğ»Ğ°Ğ³Ğ¾Ğ»Ğ¾Ğ²",
  "instruction": "Ğ’ÑÑ‚Ğ°Ğ²ÑŒ Ğ¿Ñ€Ğ¾Ğ¿ÑƒÑ‰ĞµĞ½Ğ½Ğ¾Ğµ Ğ¾ĞºĞ¾Ğ½Ñ‡Ğ°Ğ½Ğ¸Ğµ Ğ³Ğ»Ğ°Ğ³Ğ¾Ğ»Ğ°.",
  "content": "",
  "elements": [
    "Ğ¾Ğ½ Ñ‡Ğ¸Ñ‚Ğ°_Ñ‚ (I ÑĞ¿Ñ€.)",
    "Ğ¾Ğ½Ğ¸ Ğ³Ğ¾Ğ²Ğ¾Ñ€_Ñ‚ (II ÑĞ¿Ñ€.)",
    "Ğ¼Ñ‹ Ğ¿Ğ¸Ñˆ_Ğ¼ (I ÑĞ¿Ñ€.)",
    "Ñ‚Ñ‹ ÑĞ¼Ğ¾Ñ‚Ñ€_ÑˆÑŒ (II ÑĞ¿Ñ€.)",
    "Ğ²Ñ‹ Ğ¸Ğ³Ñ€Ğ°_Ñ‚Ğµ (I ÑĞ¿Ñ€.)",
    "Ğ¾Ğ½Ğ° ÑÑ‚Ñ€Ğ¾_Ñ‚ (II ÑĞ¿Ñ€.)"
  ],
  "answers": ["-Ğµ-", "-Ñ-", "-Ğµ-", "-Ğ¸-", "-Ğµ-", "-Ğ¸-"]
}`,

    // ĞœĞ°Ñ‚ĞµĞ¼Ğ°Ñ‚Ğ¸ĞºĞ°
    "Ğ¼Ğ°Ñ‚ĞµĞ¼Ğ°Ñ‚|ÑĞ»Ğ¾Ğ¶ĞµĞ½|Ğ²Ñ‹Ñ‡Ğ¸Ñ‚Ğ°Ğ½|ÑƒĞ¼Ğ½Ğ¾Ğ¶ĞµĞ½|Ğ´ĞµĞ»ĞµĞ½|Ğ¿Ñ€Ğ¸Ğ¼ĞµÑ€": `
Ğ¢Ğ•ĞœĞ: ĞœĞ°Ñ‚ĞµĞ¼Ğ°Ñ‚Ğ¸ĞºĞ°

ĞŸÑ€Ğ¸Ğ¼ĞµÑ€ 1 - Ğ ĞµÑˆĞ¸ Ğ¿Ñ€Ğ¸Ğ¼ĞµÑ€Ñ‹:
{
  "level": "â­",
  "level_name": "Ğ’Ñ‹Ñ‡Ğ¸ÑĞ»Ğ¸",
  "instruction": "Ğ ĞµÑˆĞ¸ Ğ¿Ñ€Ğ¸Ğ¼ĞµÑ€Ñ‹. ĞĞ°Ğ¿Ğ¸ÑˆĞ¸ Ğ¾Ñ‚Ğ²ĞµÑ‚.",
  "content": "",
  "elements": ["12 + 5 = ___", "18 - 7 = ___", "6 Ã— 3 = ___", "24 : 4 = ___", "15 + 8 = ___", "20 - 6 = ___"],
  "answers": ["17", "11", "18", "6", "23", "14"]
}

ĞŸÑ€Ğ¸Ğ¼ĞµÑ€ 2 - Ğ¡Ñ€Ğ°Ğ²Ğ½Ğ¸:
{
  "level": "â­â­",
  "level_name": "Ğ¡Ñ€Ğ°Ğ²Ğ½Ğ¸",
  "instruction": "ĞŸĞ¾ÑÑ‚Ğ°Ğ²ÑŒ Ğ·Ğ½Ğ°Ğº >, < Ğ¸Ğ»Ğ¸ =",
  "content": "",
  "elements": ["15 ___ 12", "8 ___ 8", "24 ___ 42", "100 ___ 99", "7 Ã— 3 ___ 20", "36 : 6 ___ 5"],
  "answers": [">", "=", "<", ">", ">", ">"]
}`,

    // Ğ‘ĞµĞ·ÑƒĞ´Ğ°Ñ€Ğ½Ñ‹Ğµ Ğ³Ğ»Ğ°ÑĞ½Ñ‹Ğµ
    "Ğ±ĞµĞ·ÑƒĞ´Ğ°Ñ€Ğ½|Ğ³Ğ»Ğ°ÑĞ½": `
Ğ¢Ğ•ĞœĞ: Ğ‘ĞµĞ·ÑƒĞ´Ğ°Ñ€Ğ½Ñ‹Ğµ Ğ³Ğ»Ğ°ÑĞ½Ñ‹Ğµ

ĞŸÑ€Ğ¸Ğ¼ĞµÑ€ 1 - Ğ’ÑÑ‚Ğ°Ğ²ÑŒ Ğ±ÑƒĞºĞ²Ñƒ:
{
  "level": "â­",
  "level_name": "Ğ’ÑÑ‚Ğ°Ğ²ÑŒ Ğ³Ğ»Ğ°ÑĞ½ÑƒÑ",
  "instruction": "Ğ’ÑÑ‚Ğ°Ğ²ÑŒ Ğ¿Ñ€Ğ¾Ğ¿ÑƒÑ‰ĞµĞ½Ğ½ÑƒÑ Ğ±ÑƒĞºĞ²Ñƒ Ğ Ğ¸Ğ»Ğ¸ Ğ. Ğ’ ÑĞºĞ¾Ğ±ĞºĞ°Ñ… Ğ½Ğ°Ğ¿Ğ¸ÑˆĞ¸ Ğ¿Ñ€Ğ¾Ğ²ĞµÑ€Ğ¾Ñ‡Ğ½Ğ¾Ğµ ÑĞ»Ğ¾Ğ²Ğ¾.",
  "content": "",
  "elements": [
    "Ğ²_Ğ´Ğ° â€” ___ (___)",
    "Ñ‚Ñ€_Ğ²Ğ° â€” ___ (___)",
    "Ğ³_Ñ€Ğ° â€” ___ (___)",
    "Ñ_ÑĞ½Ğ° â€” ___ (___)",
    "Ğ·_Ğ¼Ğ° â€” ___ (___)",
    "ÑÑ‚Ñ€_Ğ½Ğ° â€” ___ (___)"
  ],
  "answers": ["Ğ¾ (Ğ²Ğ¾Ğ´Ñ‹)", "Ğ° (Ñ‚Ñ€Ğ°Ğ²Ñ‹)", "Ğ¾ (Ğ³Ğ¾Ñ€Ñ‹)", "Ğ¾ (ÑĞ¾ÑĞ½Ñ‹)", "Ğ¸ (Ğ·Ğ¸Ğ¼Ñ‹)", "Ğ° (ÑÑ‚Ñ€Ğ°Ğ½Ñ‹)"]
}`,

    // Ğ›Ğ¾Ğ³Ğ¸ĞºĞ°
    "Ğ»Ğ¾Ğ³Ğ¸Ğº|Ğ»Ğ¸ÑˆĞ½": `
Ğ¢Ğ•ĞœĞ: Ğ›Ğ¾Ğ³Ğ¸ĞºĞ°

ĞŸÑ€Ğ¸Ğ¼ĞµÑ€ 1 - ĞĞ°Ğ¹Ğ´Ğ¸ Ğ»Ğ¸ÑˆĞ½ĞµĞµ:
{
  "level": "â­",
  "level_name": "ĞĞ°Ğ¹Ğ´Ğ¸ Ğ»Ğ¸ÑˆĞ½ĞµĞµ",
  "instruction": "ĞĞ°Ğ¹Ğ´Ğ¸ Ğ»Ğ¸ÑˆĞ½ĞµĞµ ÑĞ»Ğ¾Ğ²Ğ¾. ĞĞ±ÑŠÑÑĞ½Ğ¸ Ğ¿Ğ¾Ñ‡ĞµĞ¼Ñƒ.",
  "content": "",
  "elements": [
    "ĞºĞ¾ÑˆĞºĞ°, ÑĞ¾Ğ±Ğ°ĞºĞ°, ĞºĞ¾Ñ€Ğ¾Ğ²Ğ°, ÑÑ‚Ğ¾Ğ»",
    "ÑĞ±Ğ»Ğ¾ĞºĞ¾, Ğ³Ñ€ÑƒÑˆĞ°, Ğ¾Ğ³ÑƒÑ€ĞµÑ†, Ğ±Ğ°Ğ½Ğ°Ğ½",
    "ĞºÑ€Ğ°ÑĞ½Ñ‹Ğ¹, ÑĞ¸Ğ½Ğ¸Ğ¹, ĞºÑ€ÑƒĞ³Ğ»Ñ‹Ğ¹, Ğ·ĞµĞ»Ñ‘Ğ½Ñ‹Ğ¹",
    "Ğ±ĞµĞ¶Ğ°Ñ‚ÑŒ, Ğ¿Ñ€Ñ‹Ğ³Ğ°Ñ‚ÑŒ, ÑĞ¸Ğ´ĞµÑ‚ÑŒ, ĞºĞ½Ğ¸Ğ³Ğ°",
    "Ğ¿Ğ¾Ğ½ĞµĞ´ĞµĞ»ÑŒĞ½Ğ¸Ğº, ÑÑ€ĞµĞ´Ğ°, Ğ¾ÑĞµĞ½ÑŒ, Ğ¿ÑÑ‚Ğ½Ğ¸Ñ†Ğ°",
    "Ğ¾Ğ´Ğ¸Ğ½, Ğ´Ğ²Ğ°, Ğ¿ĞµÑ€Ğ²Ñ‹Ğ¹, Ñ‚Ñ€Ğ¸"
  ],
  "answers": [
    "ÑÑ‚Ğ¾Ğ» (Ğ½Ğµ Ğ¶Ğ¸Ğ²Ğ¾Ñ‚Ğ½Ğ¾Ğµ)",
    "Ğ¾Ğ³ÑƒÑ€ĞµÑ† (Ğ½Ğµ Ñ„Ñ€ÑƒĞºÑ‚)",
    "ĞºÑ€ÑƒĞ³Ğ»Ñ‹Ğ¹ (Ğ½Ğµ Ñ†Ğ²ĞµÑ‚)",
    "ĞºĞ½Ğ¸Ğ³Ğ° (Ğ½Ğµ Ğ´ĞµĞ¹ÑÑ‚Ğ²Ğ¸Ğµ)",
    "Ğ¾ÑĞµĞ½ÑŒ (Ğ½Ğµ Ğ´ĞµĞ½ÑŒ Ğ½ĞµĞ´ĞµĞ»Ğ¸)",
    "Ğ¿ĞµÑ€Ğ²Ñ‹Ğ¹ (Ğ¿Ğ¾Ñ€ÑĞ´ĞºĞ¾Ğ²Ğ¾Ğµ, Ğ½Ğµ ĞºĞ¾Ğ»Ğ¸Ñ‡ĞµÑÑ‚Ğ²ĞµĞ½Ğ½Ğ¾Ğµ)"
  ]
}`
};


// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// ĞŸĞĞ¡Ğ¢Ğ ĞĞ•ĞĞ˜Ğ• ĞŸĞ ĞĞœĞŸĞ¢Ğ
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

function buildPrompt(userRequest) {
    // Ğ˜Ñ‰ĞµĞ¼ Ğ¿Ğ¾Ğ´Ñ…Ğ¾Ğ´ÑÑ‰Ğ¸Ğµ Ğ¿Ñ€Ğ¸Ğ¼ĞµÑ€Ñ‹ Ğ´Ğ»Ñ Ñ‚ĞµĞ¼Ñ‹
    let examples = "";
    const requestLower = userRequest.toLowerCase();
    
    for (const [pattern, exampleText] of Object.entries(TASK_EXAMPLES)) {
        const regex = new RegExp(pattern, 'i');
        if (regex.test(requestLower)) {
            examples = exampleText;
            break;
        }
    }
    
    // Ğ•ÑĞ»Ğ¸ Ğ½Ğµ Ğ½Ğ°ÑˆĞ»Ğ¸ ÑĞ¿ĞµÑ†Ğ¸Ñ„Ğ¸Ñ‡Ğ½Ñ‹Ğµ Ğ¿Ñ€Ğ¸Ğ¼ĞµÑ€Ñ‹, Ğ´Ğ°Ñ‘Ğ¼ Ğ¾Ğ±Ñ‰Ğ¸Ğµ
    if (!examples) {
        examples = `
ĞŸÑ€Ğ¸Ğ¼ĞµÑ€ ÑƒĞ½Ğ¸Ğ²ĞµÑ€ÑĞ°Ğ»ÑŒĞ½Ğ¾Ğ³Ğ¾ Ğ·Ğ°Ğ´Ğ°Ğ½Ğ¸Ñ:
{
  "level": "â­",
  "level_name": "ĞĞ°Ğ·Ğ²Ğ°Ğ½Ğ¸Ğµ Ğ·Ğ°Ğ´Ğ°Ğ½Ğ¸Ñ",
  "instruction": "Ğ§Ñ‘Ñ‚ĞºĞ°Ñ Ğ¸Ğ½ÑÑ‚Ñ€ÑƒĞºÑ†Ğ¸Ñ Ñ‡Ñ‚Ğ¾ Ğ´ĞµĞ»Ğ°Ñ‚ÑŒ",
  "content": "Ğ”Ğ¾Ğ¿Ğ¾Ğ»Ğ½Ğ¸Ñ‚ĞµĞ»ÑŒĞ½Ğ¾Ğµ Ğ¿Ğ¾ÑÑĞ½ĞµĞ½Ğ¸Ğµ ĞµÑĞ»Ğ¸ Ğ½ÑƒĞ¶Ğ½Ğ¾",
  "elements": ["Ğ¿Ñ€Ğ¸Ğ¼ĞµÑ€ 1", "Ğ¿Ñ€Ğ¸Ğ¼ĞµÑ€ 2", "Ğ¿Ñ€Ğ¸Ğ¼ĞµÑ€ 3", "Ğ¿Ñ€Ğ¸Ğ¼ĞµÑ€ 4", "Ğ¿Ñ€Ğ¸Ğ¼ĞµÑ€ 5", "Ğ¿Ñ€Ğ¸Ğ¼ĞµÑ€ 6"],
  "answers": ["Ğ¾Ñ‚Ğ²ĞµÑ‚ 1", "Ğ¾Ñ‚Ğ²ĞµÑ‚ 2", "Ğ¾Ñ‚Ğ²ĞµÑ‚ 3", "Ğ¾Ñ‚Ğ²ĞµÑ‚ 4", "Ğ¾Ñ‚Ğ²ĞµÑ‚ 5", "Ğ¾Ñ‚Ğ²ĞµÑ‚ 6"]
}`;
    }

    return `Ğ¡Ğ¾Ğ·Ğ´Ğ°Ğ¹ Ñ€Ğ°Ğ±Ğ¾Ñ‡Ğ¸Ğ¹ Ğ»Ğ¸ÑÑ‚ Ğ´Ğ»Ñ Ğ´ĞµÑ‚ĞµĞ¹.

Ğ—ĞĞŸĞ ĞĞ¡ Ğ£Ğ§Ğ˜Ğ¢Ğ•Ğ›Ğ¯: ${userRequest}

ĞŸĞ Ğ˜ĞœĞ•Ğ Ğ« ĞŸĞ ĞĞ’Ğ˜Ğ›Ğ¬ĞĞ«Ğ¥ Ğ—ĞĞ”ĞĞĞ˜Ğ™ ĞŸĞ Ğ­Ğ¢ĞĞ™ Ğ¢Ğ•ĞœĞ•:
${examples}

Ğ¢Ğ’ĞĞ¯ Ğ—ĞĞ”ĞĞ§Ğ:
1. Ğ¡Ğ¾Ğ·Ğ´Ğ°Ğ¹ 5 Ğ·Ğ°Ğ´Ğ°Ğ½Ğ¸Ğ¹ Ğ¿Ğ¾Ñ…Ğ¾Ğ¶Ğ¸Ñ… Ğ½Ğ° Ğ¿Ñ€Ğ¸Ğ¼ĞµÑ€Ñ‹ Ğ²Ñ‹ÑˆĞµ
2. Ğ˜ÑĞ¿Ğ¾Ğ»ÑŒĞ·ÑƒĞ¹ Ğ ĞĞ—ĞĞ«Ğ• ÑĞ»Ğ¾Ğ²Ğ°/Ñ‡Ğ¸ÑĞ»Ğ° (Ğ½Ğµ ĞºĞ¾Ğ¿Ğ¸Ñ€ÑƒĞ¹ Ğ¿Ñ€Ğ¸Ğ¼ĞµÑ€Ñ‹!)
3. ĞšĞ°Ğ¶Ğ´Ğ¾Ğµ Ğ·Ğ°Ğ´Ğ°Ğ½Ğ¸Ğµ Ğ´Ğ¾Ğ»Ğ¶Ğ½Ğ¾ Ğ¸Ğ¼ĞµÑ‚ÑŒ 6-8 ÑĞ»ĞµĞ¼ĞµĞ½Ñ‚Ğ¾Ğ²
4. Ğ£Ñ€Ğ¾Ğ²Ğ½Ğ¸ ÑĞ»Ğ¾Ğ¶Ğ½Ğ¾ÑÑ‚Ğ¸: â­ â†’ â­â­ â†’ â­â­â­ â†’ â­â­â­â­ â†’ â­â­â­â­â­

Ğ’Ğ•Ğ ĞĞ˜ Ğ¢ĞĞ›Ğ¬ĞšĞ JSON:
{
  "title": "ĞĞ°Ğ·Ğ²Ğ°Ğ½Ğ¸Ğµ Ñ ÑĞ¼Ğ¾Ğ´Ğ·Ğ¸",
  "subtitle": "ĞĞ¿Ğ¸ÑĞ°Ğ½Ğ¸Ğµ",
  "tasks": [
    {Ğ·Ğ°Ğ´Ğ°Ğ½Ğ¸Ğµ 1 - ÑĞ°Ğ¼Ğ¾Ğµ Ğ¿Ñ€Ğ¾ÑÑ‚Ğ¾Ğµ â­},
    {Ğ·Ğ°Ğ´Ğ°Ğ½Ğ¸Ğµ 2 - Ğ¿Ñ€Ğ¾ÑÑ‚Ğ¾Ğµ â­â­},
    {Ğ·Ğ°Ğ´Ğ°Ğ½Ğ¸Ğµ 3 - ÑÑ€ĞµĞ´Ğ½ĞµĞµ â­â­â­},
    {Ğ·Ğ°Ğ´Ğ°Ğ½Ğ¸Ğµ 4 - ÑĞ»Ğ¾Ğ¶Ğ½Ğ¾Ğµ â­â­â­â­},
    {Ğ·Ğ°Ğ´Ğ°Ğ½Ğ¸Ğµ 5 - ÑĞ°Ğ¼Ğ¾Ğµ ÑĞ»Ğ¾Ğ¶Ğ½Ğ¾Ğµ â­â­â­â­â­}
  ],
  "motivation": "ĞœĞ¾Ğ»Ğ¾Ğ´ĞµÑ†! Ğ¢Ñ‹ Ğ¾Ñ‚Ğ»Ğ¸Ñ‡Ğ½Ğ¾ ÑĞ¿Ñ€Ğ°Ğ²Ğ¸Ğ»ÑÑ! â­"
}`;
}


// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// Ğ’Ğ«Ğ—ĞĞ’ API
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

async function callGroqAI(userRequest, apiKey) {
    
    for (const model of MODELS) {
        try {
            console.log(`ğŸ”„ ĞœĞ¾Ğ´ĞµĞ»ÑŒ: ${model}`);
            console.log(`ğŸ“ Ğ—Ğ°Ğ¿Ñ€Ğ¾Ñ: ${userRequest}`);
            
            const response = await fetch(API_URL, {
                method: "POST",
                headers: {
                    "Authorization": `Bearer ${apiKey}`,
                    "Content-Type": "application/json"
                },
                body: JSON.stringify({
                    model: model,
                    messages: [
                        { role: "system", content: SYSTEM_PROMPT },
                        { role: "user", content: buildPrompt(userRequest) }
                    ],
                    max_tokens: 4000,
                    temperature: 0.7
                })
            });
            
            if (response.status === 429) {
                console.log("âš ï¸ Ğ›Ğ¸Ğ¼Ğ¸Ñ‚, ÑĞ»ĞµĞ´ÑƒÑÑ‰Ğ°Ñ Ğ¼Ğ¾Ğ´ĞµĞ»ÑŒ...");
                await new Promise(r => setTimeout(r, 1000));
                continue;
            }
            
            if (!response.ok) {
                const err = await response.json().catch(() => ({}));
                throw new Error(err.error?.message || `HTTP ${response.status}`);
            }
            
            const data = await response.json();
            const text = data.choices?.[0]?.message?.content;
            
            if (!text) continue;
            
            console.log(`âœ… ĞŸĞ¾Ğ»ÑƒÑ‡ĞµĞ½Ğ¾ ${text.length} ÑĞ¸Ğ¼Ğ²Ğ¾Ğ»Ğ¾Ğ²`);
            
            const worksheet = extractJSON(text);
            if (worksheet && validateWorksheet(worksheet)) {
                return worksheet;
            }
            
        } catch (error) {
            console.error(`âŒ ${model}:`, error.message);
            continue;
        }
    }
    
    throw new Error("ĞÑˆĞ¸Ğ±ĞºĞ° Ğ³ĞµĞ½ĞµÑ€Ğ°Ñ†Ğ¸Ğ¸. ĞŸĞ¾Ğ¿Ñ€Ğ¾Ğ±ÑƒĞ¹ ĞµÑ‰Ñ‘ Ñ€Ğ°Ğ· Ğ¸Ğ»Ğ¸ Ğ¸Ğ·Ğ¼ĞµĞ½Ğ¸ Ğ·Ğ°Ğ¿Ñ€Ğ¾Ñ.");
}


// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// ĞĞ‘Ğ ĞĞ‘ĞĞ¢ĞšĞ ĞĞ¢Ğ’Ğ•Ğ¢Ğ
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

function extractJSON(text) {
    // Ğ£Ğ±Ğ¸Ñ€Ğ°ĞµĞ¼ markdown
    text = text.replace(/```json\s*/gi, "");
    text = text.replace(/```\s*/gi, "");
    
    // Ğ˜Ñ‰ĞµĞ¼ JSON
    const match = text.match(/\{[\s\S]*\}/);
    if (!match) {
        console.error("JSON Ğ½Ğµ Ğ½Ğ°Ğ¹Ğ´ĞµĞ½");
        throw new Error("AI Ğ½Ğµ Ğ²ĞµÑ€Ğ½ÑƒĞ» JSON");
    }
    
    try {
        let jsonStr = match[0];
        // Ğ˜ÑĞ¿Ñ€Ğ°Ğ²Ğ»ÑĞµĞ¼ Ñ‡Ğ°ÑÑ‚Ñ‹Ğµ Ğ¾ÑˆĞ¸Ğ±ĞºĞ¸
        jsonStr = jsonStr.replace(/,\s*}/g, "}");
        jsonStr = jsonStr.replace(/,\s*]/g, "]");
        
        return JSON.parse(jsonStr);
    } catch (e) {
        console.error("ĞÑˆĞ¸Ğ±ĞºĞ° Ğ¿Ğ°Ñ€ÑĞ¸Ğ½Ğ³Ğ°:", e.message);
        throw new Error("ĞÑˆĞ¸Ğ±ĞºĞ° Ğ¿Ğ°Ñ€ÑĞ¸Ğ½Ğ³Ğ° Ğ¾Ñ‚Ğ²ĞµÑ‚Ğ°");
    }
}


function validateWorksheet(data) {
    if (!data.title || !data.tasks || !Array.isArray(data.tasks)) {
        console.error("ĞĞµĞ²ĞµÑ€Ğ½Ğ°Ñ ÑÑ‚Ñ€ÑƒĞºÑ‚ÑƒÑ€Ğ°");
        return false;
    }
    
    if (data.tasks.length < 3) {
        console.error("ĞœĞ°Ğ»Ğ¾ Ğ·Ğ°Ğ´Ğ°Ğ½Ğ¸Ğ¹");
        return false;
    }
    
    // Ğ—Ğ°Ğ¿Ğ¾Ğ»Ğ½ÑĞµĞ¼ Ğ¿Ñ€Ğ¾Ğ¿ÑƒÑĞºĞ¸
    data.subtitle = data.subtitle || "Ğ Ğ°Ğ·Ğ²Ğ¸Ğ²Ğ°ÑÑ‰Ğ¸Ğµ Ğ·Ğ°Ğ´Ğ°Ğ½Ğ¸Ñ";
    data.motivation = data.motivation || "ĞœĞ¾Ğ»Ğ¾Ğ´ĞµÑ†! Ğ¢Ñ‹ ÑĞ¿Ñ€Ğ°Ğ²Ğ¸Ğ»ÑÑ! â­";
    
    const levels = ["â­", "â­â­", "â­â­â­", "â­â­â­â­", "â­â­â­â­â­"];
    const names = ["Ğ Ğ°Ğ·Ğ¼Ğ¸Ğ½ĞºĞ°", "Ğ¢Ñ€ĞµĞ½Ğ¸Ñ€Ğ¾Ğ²ĞºĞ°", "Ğ—Ğ°ĞºÑ€ĞµĞ¿Ğ»ĞµĞ½Ğ¸Ğµ", "Ğ¡Ğ»Ğ¾Ğ¶Ğ½Ğ¾Ğµ", "Ğ”Ğ»Ñ Ğ·Ğ½Ğ°Ñ‚Ğ¾ĞºĞ¾Ğ²"];
    
    // ĞŸÑ€Ğ¾Ğ²ĞµÑ€ÑĞµĞ¼ Ğ¸ Ñ‡Ğ¸ÑÑ‚Ğ¸Ğ¼ Ğ·Ğ°Ğ´Ğ°Ğ½Ğ¸Ñ
    data.tasks = data.tasks.map((task, i) => {
        let elements = task.elements || [];
        if (!Array.isArray(elements)) elements = [String(elements)];
        elements = elements.map(e => String(e).trim()).filter(e => e);
        
        let answers = task.answers || [];
        if (!Array.isArray(answers)) answers = [String(answers)];
        answers = answers.map(a => String(a).trim()).filter(a => a);
        
        return {
            level: task.level || levels[i] || "â­",
            level_name: task.level_name || names[i] || `Ğ—Ğ°Ğ´Ğ°Ğ½Ğ¸Ğµ ${i + 1}`,
            instruction: task.instruction || "Ğ’Ñ‹Ğ¿Ğ¾Ğ»Ğ½Ğ¸ Ğ·Ğ°Ğ´Ğ°Ğ½Ğ¸Ğµ",
            content: task.content || "",
            elements: elements,
            answers: answers
        };
    });
    
    // Ğ¤Ğ¸Ğ»ÑŒÑ‚Ñ€ÑƒĞµĞ¼ Ğ¿ÑƒÑÑ‚Ñ‹Ğµ
    data.tasks = data.tasks.filter(t => t.elements.length > 0);
    
    if (data.tasks.length < 3) {
        console.error("ĞŸĞ¾ÑĞ»Ğµ Ñ„Ğ¸Ğ»ÑŒÑ‚Ñ€Ğ°Ñ†Ğ¸Ğ¸ Ğ¼Ğ°Ğ»Ğ¾ Ğ·Ğ°Ğ´Ğ°Ğ½Ğ¸Ğ¹");
        return false;
    }
    
    console.log("âœ… Ğ’Ğ°Ğ»Ğ¸Ğ´Ğ°Ñ†Ğ¸Ñ OK, Ğ·Ğ°Ğ´Ğ°Ğ½Ğ¸Ğ¹:", data.tasks.length);
    return true;
}